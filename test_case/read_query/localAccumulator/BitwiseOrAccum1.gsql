#######################################################################
# Target: (Positive) test sample local BitwiseOrAccum
# Description: test local BitwiseOrAccum with different values (int, double, string)
#              and functions(.reset(), .cardinality(), etc.)
#            SYNTAX v2 not supported yet
#            Sample results are random, only check the size of the results
# Designer: Darren Wang
# Date: 2022-06-09
# Doc: https://docs.tigergraph.com/gsql-ref/current/querying/accumulators#_bitwiseOrorOrororaccum_bitwiseoraccum
########################################################################

CREATE OR REPLACE QUERY localAccum_BitwiseOrAccum101 (DATETIME date, DATETIME date2) {
  SumAccum<UINT>   @@sumUint;

  BitwiseOrAccum @BitwiseorResult; // default value = 64-bits of 1 = -1 INT
  BitwiseOrAccum @@BitwiseorResult1;

  S = SELECT s FROM tupPerson:s -(<TUP_MEMBER:e)- _:t
    WHERE e.creationDate > date AND e.creationDate < date2 AND t.title =="Wall of Eduardo Rodriguez"
    ACCUM
      @@sumUint += 1,
      s.@BitwiseorResult += e.creationEpoch,
      s.@BitwiseorResult += 9998,
      #Use a global Accun to verify result
      @@BitwiseorResult1 += e.creationEpoch,
      @@BitwiseorResult1 += 9998;
      #Test all functions
    PRINT S [S.@BitwiseorResult, S.@BitwiseorResult.cardinality(), S.@BitwiseorResult.get(1),
    S.@BitwiseorResult.set(0,FALSE), S.@BitwiseorResult.flip(1), S.@BitwiseorResult.flip(0 , 15)];

  PRINT @@sumUint;
  PRINT @@BitwiseorResult1;


}